{{ define "main"}}

{{- $.Scratch.Set "tags" (slice ) -}}
{{- $.Scratch.Set "licenses" (slice ) -}}
{{- $.Scratch.Set "hugoversion" (slice ) -}}

{{- $.Scratch.Set "untagged" (slice ) -}}

{{- range .Site.Data.themes.themes -}}
  {{- with .tags -}}
    {{- range . -}}
      {{- if and ( not ( in ( $.Scratch.Get "tags" ) ( . | urlize ) ) ) ( gt ( len . ) 0 ) -}}
        {{- $.Scratch.Add "tags" ( slice ( . | urlize ) ) -}}
      {{- end -}}
    {{- end -}}
  {{- end -}}
  {{- if and ( not ( in ( $.Scratch.Get "licenses" ) ( .license | replaceRE "[.]" "_" | urlize ) ) ) ( gt ( len .license ) 0 ) -}}
    {{- $.Scratch.Add "licenses" ( slice ( .license | replaceRE "[.]" "_" | urlize ) ) -}}
  {{- end -}}
  
  {{- with .min_version -}}
      {{- if ( not ( in ( $.Scratch.Get "hugoversion" ) ( string . ) ) ) -}}
        {{- $.Scratch.Add "hugoversion" ( slice ( string . ) ) -}}
      {{- end -}}
  {{- end -}}
{{- end -}}


<div class="container-fluid main-container">
  <div class="columns is-mobile">
    <div class="column is-two-thirds card-wrapper">
      <div class="tabs is-small has-background-white sticky status-tabs">
        <ul>
          <li><a><span id="selectedThemeCount"></span>&nbsp; of {{ len .Site.Data.themes.themes }} themes</a></li>
          <li><a><span id="selectedTagsCount"></span>&nbsp;  {{ len ($.Scratch.Get "tags") }} tags</a></li>
          <li><a><span id="selectedLicCount"></span>&nbsp;  {{ len ($.Scratch.Get "licenses") }} licenses</a></li>
          <li><a><span id="selectedVerStatus">All</span>&nbsp; Hugo Version</a></li>
        </ul>
      </div>
      {{partial "notif.html" . }}
      
        {{ range .Site.Data.themes.themes | shuffle }}
          <div 
              id="theme-{{.name|urlize}}"
              class="filterDiv card"
              data-tags="{{ range .tags }}{{ . | replaceRE "[.]" "_" | urlize }} {{ end }}"
              data-license="{{ .license | replaceRE "[.]" "_" |urlize}}"
              data-minver="{{.min_version}}"
          >
            <header class="card-header">
              <div class="card-header-title">
                {{.name}}
              </div>
              <div class="tags">
                <div class="tag">{{with .min_version}}Hugo v{{.}}{{else}}No Hugo Version Specified{{end}}</div>
                <div class="tag">{{with .license}}{{.}}{{else}}No License Specified{{end}}</div>
              {{if isset . "repo_updated"}}
                  <div class="tag">â˜… {{.repo_stars}}</div>
                  <div class="tag is-white">{{ .repo_updated | dateFormat "Jan 2006"}}</div> 
              {{end}}
            </div>
            </header>
            {{- with .colors}}
              <div class="colors">
              {{ range . }}<span class="color" style="background-color:{{.}}">&nbsp;</span>{{ end }}
            </div>
            {{ end }}
            <div class="card-content is-size-7">

              <div class="content">
                {{with .description}}<p>{{ . }}</p>{{ end }}
                {{- with .tags}}
                  <div class="buttons">
                    {{ range . }}
                      {{ if gt ( len . ) 0 }}
                      <button class="button is-small item-tags-button" onclick="tagsCheck('{{ . | replaceRE "[.]" "_"| urlize }}', 't-')">
                        {{- . -}}
                      </button> 
                      {{ end }}
                    {{ end }}
                  </div>
                {{ end }}
                
                {{- with .features }}
                  
                  <div class="tags">
                    {{- if eq ( printf "%T" . ) "[]interface {}" }}
                      {{ if gt ( len . ) 0 }}
                        {{range .}}{{ if gt ( len . ) 0 }}<div class="tag is-small">{{.}}</div>{{ end }}{{ end }}
                      {{ end }}
                    {{ else }}<div class="tag is-small">{{ . }}</div>
                    {{ end }}
                  </div>
                {{end}}
                
              </div>
            </div>
            <footer class="card-footer is-size-7">
              <span class="card-footer-item"><a href="https://themes.gohugo.io/{{.path | urlize}}">Hugo Theme Page</a></span>
              {{with .homepage}}<span class="card-footer-item"><a href="{{.}}">Theme Homepage</a></span>{{ end }}
              
            </footer>
          </div>

        {{ end }}

    </div>
    <div class="column is-one-third side">
      {{ partial "sidebar.html" . }}
    </div>

  </div>
</div>
{{ end }}