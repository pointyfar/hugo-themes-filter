{{ define "main" }}

{{- $.Scratch.Set "tags" (slice ) -}}
{{- $.Scratch.Set "licenses" (slice ) -}}
{{- $.Scratch.Set "hugoversion" (slice ) -}}

{{- $.Scratch.Set "untagged" (slice ) -}}

{{- range .Site.Data.themes.themes -}}
  {{- with .tags -}}
    {{- range . -}}
      {{- if and ( not ( in ( $.Scratch.Get "tags" ) ( . | urlize ) ) ) ( gt ( len . ) 0 ) -}}
        {{- $.Scratch.Add "tags" ( slice ( . | urlize ) ) -}}
      {{- end -}}
    {{- end -}}
  {{- end -}}
  {{- if and ( not ( in ( $.Scratch.Get "licenses" ) ( .license | replaceRE "[.]" "_" | urlize ) ) ) ( gt ( len .license ) 0 ) -}}
    {{- $.Scratch.Add "licenses" ( slice ( .license | replaceRE "[.]" "_" | urlize ) ) -}}
  {{- end -}}
  
  {{- with .min_version -}}
      {{- if ( not ( in ( $.Scratch.Get "hugoversion" ) ( string . ) ) ) -}}
        {{- $.Scratch.Add "hugoversion" ( slice ( string . ) ) -}}
      {{- end -}}
  {{- end -}}
{{- end -}}

<div class="uk-background-muted status-bar uk-text-small">
  <div class="status"><div class="status-inner"><span id="selectedThemeCount"></span> of {{ len .Site.Data.themes.themes }} </div><div class="status-inner">&nbsp;themes</div></div>
  <div class="status-separator">|</div>
  <div class="status"><div class="status-inner"><span id="selectedTagsCount"></span> {{ len ($.Scratch.Get "tags") }} </div><div class="status-inner">&nbsp;tags</div></div>
  <div class="status-separator">|</div>
  <div class="status"><div class="status-inner"><span id="selectedLicCount"></span> {{ len ($.Scratch.Get "licenses") }} </div><div class="status-inner">&nbsp;licenses</div></div>
  <div class="status-separator">|</div>
  <div class="status"><div class="status-inner"><span id="selectedVerStatus">All</span></div><div class="status-inner">&nbsp;Hugo Version</div></div>
  <div class="status-separator">|</div>
  <div class="status"><div class="status-inner">Last Updated </div><div class="status-inner">&nbsp;{{ now.Format "2 Jan 2006" }}</div></div>
  
</div>
    <div class="uk-container uk-container-expand wrapper">
      <div class="content-wrapper">
        <main class="main">
          <div class="wall">
            {{ range .Site.Data.themes.themes }}
            <div class="item">
              <div id="theme-{{.name|urlize}}"
                  class="filterDiv box"
                  data-tags="{{ range .tags }}{{ . | replaceRE "[.]" "_" | urlize }} {{ end }}"
                  data-license="{{ .license | replaceRE "[.]" "_" |urlize}}"
                  data-minver="{{.min_version}}"
                >
                <div class="theme-box">
                  <h6 class="uk-card-title">{{.name}}</h6>
                  {{with .description}}<p>{{ . }}</p>{{ end }}
                  <span class="uk-label uk-background-muted tag-label"><a href="https://themes.gohugo.io/{{.path | urlize}}">Hugo Theme Page</a></span>
                  {{with .homepage}}<span class="uk-label uk-background-muted tag-label"><a href="{{.}}">Theme Homepage</a></span>{{ end }}
                  
                  <br />{{with .min_version}}{{.}}{{else}}No Version Specified{{end}} | {{with .license}}{{.}}{{else}}No License Specified{{end}}
                  {{with .colors}}
                  <br />{{ range . }}<span class="dot" style="background-color:{{.}}">&nbsp;</span>{{ end }}
                  {{ end }}
                  {{with .tags}}
                  <div class="uk-margin item-tags-container">
                    {{ range . }}{{ if gt ( len . ) 0 }}
                    <button class="uk-button uk-button-small uk-button-text item-tags-button" onclick="tagsCheck('{{ . | replaceRE "[.]" "_"| urlize }}', 't-')">
                      {{- . | humanize -}}
                    </button> 
                    {{ end }}{{ end }}
                  </div>
                  {{ end }}
                  {{with .features }}
                    <button class="uk-button uk-button-default uk-button-small uk-width-1-1" type="button">Features</button>
                    <div uk-drop="pos: top-left; boundary: .wall; mode:click">
                        <div class="uk-card uk-card-body uk-card-default">
                          {{ range . }}{{ if gt ( len . ) 0 }}<span> | {{.}}  </span>{{end}}{{end}}|
                        </div>
                    </div>
                  {{end}}
                </div>
              </div>
            </div>

            {{ end }}
          </div>
        </main>
        
        <aside class="">
          <ul class="" uk-tab uk-switcher>
            <li class="active"><a class="uk-width-1-1 uk-text-truncate" href="#">Tags</a></li>
            <li><a class="uk-width-1-1 uk-text-truncate" href="#">Licenses</a></li>
            <li><a class="uk-width-1-1 uk-text-truncate" href="#">Version</a></li>
          </ul>
          <ul class="uk-switcher">
            <li>
              <div class="uk-width-1-1 uk-padding-small">
                <form class="uk-search uk-search-default">
                  <span class="uk-form-icon" uk-icon="icon: search"></span>
                  <input class="uk-input" type="text" id="tagSearch" onkeyup="searchTermFilter('tagSearch', 'tag-btn', 'span', 'hideBtn' )">
                  <a class="uk-form-icon uk-form-icon-flip" href="#" uk-icon="icon: close" onclick="document.getElementById('tagSearch').value = '';searchFilter('tag', 'tagSearch')"></a>
                </form>
              </div>
              <div class="tab_pane_container uk-padding-small uk-margin tab-buttons-container">
                <button class="uk-button uk-button-default uk-button-small" id="selectAllTags" onclick="showAll()">Show all</button>
                {{- range sort ( $.Scratch.Get "tags" ) "value" "asc" -}}
                <button class="uk-button uk-button-default uk-button-small tag-btn {{.}}" 
                        id="t-{{. | replaceRE "[.]" "_" | urlize }}" 
                        onclick="tagsCheck('{{ . | replaceRE "[.]" "_"| urlize }}', 't-')"><span>{{- . | humanize | upper -}}</span></button>
                {{ end }}
              </div>
            </li>
            <li>
              <div class="tab_pane_container uk-padding-small  tab-buttons-container">
                <button class="uk-button uk-button-default uk-button-small uk-width-1-1" id="selectAllLicenses" onclick="licenseCheck('')">
                  All Licenses
                </button>
                {{ range sort ( $.Scratch.Get "licenses" ) "value" "asc" }}
                <button class="uk-button uk-button-default uk-button-small  license-btn" id="l-{{ . | urlize }}" onclick="tagsCheck('{{ . | replaceRE "[.]" "_" | urlize}}', 'l-')">
                  {{ . | replaceRE "[_]" "." | humanize | upper }}
                </button>
                {{ end }}
              </div>

            <li style="min-height: calc(100vh - 165px);">
              <div class="tab_pane_container uk-padding-small">
                <form class="form">
                  <label>Match Hugo Versions</label>
                  <div class="form-item">
                      <select class="uk-select" id="versionSelect" onchange="versionSelected()">
                        <option>Select All</option>
                        {{range sort ($.Scratch.Get "hugoversion") "value" "desc" }}<option>{{.}}</option>{{end}}
                      </select>
                  </div>
                  <div class="form-item">
                    <label class="checkbox"><input name="versionMatch" class="uk-radio" value="e" type="radio" onchange="versionSelected()" checked> Exactly</label>
                    <label class="checkbox"><input name="versionMatch" class="uk-radio" value="gte" onchange="versionSelected()" type="radio"> Greater than or equal</label>
                    <label class="checkbox"><input name="versionMatch" class="uk-radio" value="lte" onchange="versionSelected()" type="radio"> Less than or equal</label>
                  </div>
                </form>
              </div>
            </li>
          </ul>


        </aside>
      </div>
    </div>

<script src="/js/{{index .Site.Data.hash "filter.js"}}"></script>
{{ end }}